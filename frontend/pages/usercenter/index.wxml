<!-- /pages/usercenter/index.wxml -->

<view class="profile-page">
  <!-- 用户信息卡片 -->
  <view class="user-card">
    <!-- 用户头像 -->
    <image class="user-avatar" src="{{userInfo.avatar || 'https://cloud.tsinghua.edu.cn/f/9a5d8ec171fa4541a9f4/?dl=1'}}" />

    <!-- 用户名 -->
    <view class="user-name">{{userInfo.nickname || 'Anonymous'}}</view>

    <!-- 用户格言 -->
    <text class="user-motto">{{userInfo.personality_description || 'Live and let live.'}}</text>

  </view>

  <!-- 饮食禁忌选择区域 -->
  <view class="dietary-section">
    <!-- 宗教信仰选择 -->
    <view class="picker-container">
      <text class="picker-label">Religious Belief:</text>
      <picker mode="selector" range="{{religiousBeliefs}}" bindchange="onReligiousChange">
        <view class="picker">
          {{selectedReligiousBelief || 'Select your religious belief'}}
        </view>
      </picker>
    </view>

    <!-- 饮食禁忌选择按钮 -->
    <view class="picker-container">
      <button class="select-dietary-button" bindtap="openDietaryModal">Dietary Restrictions</button>
      <text> (Click to Select):</text>

      <!-- Display Selected Dietary Restrictions as Tags -->
      <view class="selected-dietary-restrictions">
        <block wx:for="{{selectedDietaryRestrictions}}" wx:key="*this">
          <text class="restriction-tag">{{item}}</text>
        </block>
        <block wx:if="{{selectedDietaryRestrictions.length === 0}}">
          <text class="placeholder-text">No dietary restrictions selected</text>
        </block>
      </view>
    </view>
  </view>

  <!-- Modal for Dietary Restrictions -->
  <view wx:if="{{showDietaryModal}}" class="modal-overlay">
    <view class="modal">
      <view class="modal-header">
        <text class="modal-title">Select Dietary Restrictions</text>
        <button class="close-button" bindtap="closeDietaryModal">✕</button>
      </view>
      <view class="modal-body">
        <checkbox-group bindchange="onDietaryCheckboxChange">
          <block wx:for="{{dietaryRestrictions}}" wx:key="*this">
            <label class="checkbox-label">
              <checkbox value="{{item}}"></checkbox>
              <text class="checkbox-text">{{item}}</text>
            </label>
          </block>
        </checkbox-group>
      </view>
      <view class="modal-footer">
        <button class="save-button" bindtap="saveDietaryRestrictions">Save</button>
      </view>
    </view>
  </view>

  <view class="settings-section">
    <view class="settings-item" bindtap="goToLikes">My likes</view>
  </view>

  <!-- 设置和其他操作 -->
  <view class="settings-section">
    <view class="settings-item" bindtap="goToSetting">Settings</view>
    <view class="settings-item" bindtap="onQuitAccount">Quit this account</view>
    <view class="settings-item" bindtap="onClearCookies">Clear all cookies</view>
    <view class="settings-item">
      <text>Version</text>
      <text class="version-text">v1.0 beta5</text>
    </view>
  </view>
</view>